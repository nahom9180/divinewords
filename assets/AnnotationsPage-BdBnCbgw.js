import{r as d,j as r}from"./index-YW6-nJEG.js";function k({annotations:a,getVerseText:u,onNavigateToVerse:f}){const[p,j]=d.useState("newest"),[i,g]=d.useState(!0),[c,b]=d.useState(null),m=d.useMemo(()=>{const e=new Set;return a.forEach(l=>{l.color&&e.add(l.color)}),Array.from(e)},[a]),x=d.useMemo(()=>{let e=[...a];c&&(e=e.filter(t=>t.color===c)),e.sort((t,s)=>{const o=t.book.localeCompare(s.book);return o!==0?o:t.chapter!==s.chapter?t.chapter-s.chapter:t.verse-s.verse});const l=[];if(e.length>0){let t=[e[0]];for(let s=1;s<e.length;s++){const o=t[t.length-1],n=e[s],N=n.book===o.book&&n.chapter===o.chapter&&n.verse===o.verse+1,v=n.color===o.color;N&&v?t.push(n):(l.push(h(t)),t=[n])}l.push(h(t))}return l.sort((t,s)=>{switch(p){case"newest":return s.updatedAt-t.updatedAt;case"oldest":return t.updatedAt-s.updatedAt;case"book":const o=t.book.localeCompare(s.book);return o!==0?o:t.chapter-s.chapter||t.startVerse-s.startVerse;case"color":return(t.color||"").localeCompare(s.color||"");default:return 0}}),l},[a,p,c]);function h(e){const t=e.map(o=>o.note).filter(o=>o&&o.trim().length>0).join(`

`),s=Math.max(...e.map(o=>o.updatedAt));return{id:e[0].id,annotations:e,color:e[0].color,book:e[0].book,chapter:e[0].chapter,startVerse:e[0].verse,endVerse:e[e.length-1].verse,updatedAt:s,mergedNote:t}}return r.jsxs("div",{className:"min-h-screen bg-bg text-text p-2 sm:p-6 max-w-5xl mx-auto font-sans animate-in fade-in duration-300 pt-20",children:[r.jsx("div",{className:"flex items-center justify-between mb-6 border-b border-border pb-4",children:r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl sm:text-3xl font-serif font-bold text-brand",children:"My Annotations"}),r.jsxs("p",{className:"text-sm opacity-60",children:[x.length," entries found",x.length!==a.length&&` (merged from ${a.length} verses)`]})]})}),r.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 justify-between bg-card p-4 rounded-lg border border-border",children:[r.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-[10px] uppercase font-bold opacity-50",children:"Sort Order"}),r.jsxs("select",{value:p,onChange:e=>j(e.target.value),className:"bg-bg border border-border rounded p-1.5 text-sm focus:border-brand outline-none",children:[r.jsx("option",{value:"newest",children:"Newest First"}),r.jsx("option",{value:"oldest",children:"Oldest First"}),r.jsx("option",{value:"book",children:"Book (A-Z)"}),r.jsx("option",{value:"color",children:"Color Group"})]})]}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-[10px] uppercase font-bold opacity-50",children:"Content"}),r.jsx("button",{onClick:()=>g(!i),className:`px-3 py-1.5 rounded border text-sm font-bold transition-colors ${i?"bg-brand text-white border-brand":"bg-bg border-border text-text"}`,children:i?"Hide Scripture":"Show Scripture"})]})]}),m.length>0&&r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("label",{className:"text-[10px] uppercase font-bold opacity-50",children:"Filter by Color"}),r.jsxs("div",{className:"flex gap-2 items-center",children:[r.jsx("button",{onClick:()=>b(null),className:`w-6 h-6 rounded-full border flex items-center justify-center ${c===null?"border-brand ring-1 ring-brand":"border-border bg-bg"}`,title:"All",children:r.jsx("span",{className:"text-xs font-bold opacity-50",children:"All"})}),m.map(e=>r.jsx("button",{onClick:()=>b(e===c?null:e),className:`w-6 h-6 rounded-full border shadow-sm transition-transform ${c===e?"scale-125 border-text":"border-transparent"}`,style:{backgroundColor:e}},e))]})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.length===0?r.jsx("div",{className:"col-span-full text-center py-12 opacity-50 italic border-2 border-dashed border-border rounded-xl",children:"No annotations match your criteria."}):x.map(e=>{const l=e.startVerse!==e.endVerse,t=`${e.book} ${e.chapter}:${e.startVerse}${l?"-"+e.endVerse:""}`;return r.jsxs("div",{onClick:()=>f(e.book,e.chapter,e.startVerse),className:"bg-card border border-border rounded-lg p-4 hover:border-brand cursor-pointer group transition-all",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[e.color&&r.jsx("div",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:e.color}}),r.jsx("h3",{className:"font-bold text-brand font-serif",children:t})]}),r.jsx("span",{className:"text-[10px] opacity-40 font-mono",children:new Date(e.updatedAt).toLocaleDateString()})]}),i&&r.jsx("div",{className:"mb-3 p-2 bg-bg/50 rounded border-l-2 border-brand/50 text-sm font-serif italic opacity-80 space-y-2",children:e.annotations.map(s=>r.jsxs("div",{className:"block",children:[r.jsx("sup",{className:"text-[0.6em] mr-1 opacity-60 font-bold",children:s.verse}),u(s.book,s.chapter,s.verse)]},s.verse))}),e.mergedNote?r.jsx("p",{className:"text-sm opacity-90 leading-relaxed whitespace-pre-wrap",children:e.mergedNote}):r.jsx("p",{className:"text-xs opacity-40 italic",children:"No additional note."})]},e.id)})}),r.jsx("div",{className:"mt-8 text-center",children:r.jsx("p",{className:"text-xs opacity-30",children:"End of list"})})]})}export{k as AnnotationsPage};
