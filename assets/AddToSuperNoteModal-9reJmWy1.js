import{r as s,d as n,j as e}from"./index-Cen6tLtI.js";const v=({content:r,onClose:l,onSuccess:i})=>{const[c,p]=s.useState([]),[a,u]=s.useState(""),[x,b]=s.useState("select");s.useEffect(()=>{n.getCollections().then(t=>{p(t.sort((o,d)=>d.updatedAt-o.updatedAt))})},[]);const m=async t=>{const o=[];r.annotationId?o.push({id:`ref_${Date.now()}_${Math.random()}`,type:"ref",ref:r.reference,annotationId:r.annotationId}):(r.note&&r.note.trim()&&o.push({id:`txt_${Date.now()}_${Math.random()}`,type:"text",content:r.note}),o.push({id:`ref_${Date.now()}_${Math.random()}`,type:"ref",ref:r.reference}));const d={...t,items:[...t.items||[],...o],updatedAt:Date.now()};await n.saveCollection(d),window.dispatchEvent(new Event("DATA_REFRESH")),i&&i(t.name),l()},h=async()=>{if(!a.trim())return;const t={name:a.trim(),items:[],createdAt:Date.now(),updatedAt:Date.now()};await n.saveCollection(t),m(t)};return e.jsxs("div",{className:"bg-bg border border-border w-full max-w-sm rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh] animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-border bg-card flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Add to SuperNote"}),e.jsx("button",{onClick:l,className:"text-xl opacity-50 hover:opacity-100",children:"Ã—"})]}),e.jsxs("div",{className:"p-4 bg-card/50 border-b border-border/50",children:[e.jsx("div",{className:"text-xs font-bold uppercase opacity-50 mb-1",children:"Adding Item"}),e.jsx("div",{className:"font-bold text-brand",children:r.reference}),r.annotationId?e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-brand/80 bg-brand/10 w-fit px-2 py-0.5 rounded-full",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{children:"Linked to Annotation"})]}):r.note&&e.jsxs("div",{className:"text-xs opacity-60 truncate mt-1",children:['"',r.note,'"']})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[x==="select"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>b("create"),className:"w-full p-3 border-2 border-dashed border-border rounded-lg text-xs font-bold uppercase opacity-60 hover:opacity-100 hover:border-brand hover:text-brand transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),"Create New SuperNote"]}),c.length===0?e.jsx("div",{className:"text-center py-4 opacity-50 text-xs",children:"No SuperNotes found."}):c.map(t=>{var o;return e.jsxs("button",{onClick:()=>m(t),className:"w-full text-left p-3 bg-card border border-border rounded-lg hover:border-brand transition-all group",children:[e.jsx("div",{className:"font-bold text-sm",children:t.name}),e.jsxs("div",{className:"text-[10px] opacity-50",children:[((o=t.items)==null?void 0:o.length)||0," blocks"]})]},t.name)})]}),x==="create"&&e.jsxs("div",{className:"p-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase opacity-60 block mb-2",children:"SuperNote Title"}),e.jsx("input",{type:"text",className:"w-full bg-bg border border-border rounded p-2 text-sm focus:border-brand outline-none mb-4",placeholder:"e.g. Sermon on Faith",value:a,onChange:t=>u(t.target.value),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b("select"),className:"flex-1 py-2 border border-border rounded text-xs font-bold",children:"Cancel"}),e.jsx("button",{onClick:h,className:"flex-1 py-2 bg-brand text-white rounded text-xs font-bold",children:"Create & Add"})]})]})]})]})};export{v as AddToSuperNoteModal};
