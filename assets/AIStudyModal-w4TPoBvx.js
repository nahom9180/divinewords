import{r as s,b as C,j as e,M}from"./index-Cen6tLtI.js";import{a as I}from"./aiService-CPwEHgnh.js";const G=({verse:x,translation:h,onClose:b,onSaveToNote:w})=>{const[n,N]=s.useState(x.reference),[o,p]=s.useState(""),[a,m]=s.useState(""),[t,u]=s.useState(!1),[f,g]=s.useState(null),l=s.useRef(null),i=C(r=>r.aiConfig),y=[...["Explain theological significance","Historical context","Practical application","Key Greek/Hebrew words","Cross-references","Summarize this verse","Scientific correlation"],...i.customPrompts||[]],v=async r=>{u(!0),g(null),m(""),p("");const c=`Context: ${n} (${h.displayName})
Scripture Text: "${x.text}"

Request: ${r}`;try{const d=I.generateInsightStream(c,i);for await(const S of d)m(L=>L+S),l.current&&(l.current.scrollTop=l.current.scrollHeight)}catch(d){console.error(d),g(d.message||"Failed to generate insight.")}finally{u(!1)}},j=()=>{o.trim()&&v(o)},k=()=>{const r=`[AI Study: ${n}]
Query: ${o||"Insight"}
`;w(r+a),b()};return e.jsxs("div",{className:"bg-bg border border-border w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden flex flex-col h-[75vh] sm:max-h-[85vh] relative ring-1 ring-white/10 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-border bg-card flex flex-col gap-3 shrink-0 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-brand/5 via-transparent to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-center relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-brand/20 text-brand rounded-lg",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 9l1.25-2.75L23 5l-2.75-1.25L19 1l-1.25 2.75L15 5l2.75 1.25L19 9zm-7.5.5L9 6 6.5 9.5 3 12l3.5 2.5L9 18l2.5-3.5L15 12l-3.5-2.5zM19 15l-1.25 2.75L15 19l2.75 1.25L19 23l1.25-2.75L23 19l-2.75-1.25L19 15z"})})}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-brand opacity-80",children:"AI Assistant"})]}),e.jsx("button",{onClick:b,className:"p-1 rounded-full hover:bg-white/10 opacity-50 hover:opacity-100 transition-colors",children:e.jsx("span",{className:"text-xl leading-none",children:"Ã—"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold uppercase opacity-40 block mb-1",children:"Context / Topic"}),e.jsx("input",{type:"text",value:n,onChange:r=>N(r.target.value),className:"w-full bg-bg border-b border-border border-transparent hover:border-brand/50 focus:border-brand text-lg font-bold outline-none py-1 transition-colors font-serif"})]})]}),e.jsx("div",{ref:l,className:"flex-1 overflow-y-auto p-6 bg-bg custom-scrollbar relative scroll-smooth",children:a?e.jsxs("div",{className:"prose prose-invert prose-sm max-w-none prose-headings:text-brand prose-strong:text-brand prose-blockquote:border-brand",children:[e.jsx(M,{children:a}),t&&e.jsx("span",{className:"inline-block w-2 h-4 bg-brand ml-1 animate-pulse align-middle"})]}):e.jsx("div",{className:"h-full flex flex-col items-center justify-center opacity-40 text-center px-8",children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-8 h-8 border-2 border-brand border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-sm font-mono animate-pulse",children:"Thinking..."})]}):f?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-10 h-10 text-red-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm text-red-400",children:f})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-12 h-12 mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsxs("p",{className:"text-lg font-bold mb-2",children:["Ask a question about ",n]}),e.jsx("p",{className:"text-xs max-w-xs leading-relaxed",children:"Select a suggestion below or type your own question to get theological insights, historical context, or application ideas."})]})})}),e.jsxs("div",{className:"border-t border-border bg-card shrink-0 flex flex-col",children:[e.jsx("div",{className:"flex overflow-x-auto gap-2 p-3 no-scrollbar mask-gradient-right",children:y.map((r,c)=>e.jsx("button",{onClick:()=>v(r),disabled:t,className:"whitespace-nowrap px-3 py-1.5 bg-bg border border-border rounded-full text-xs font-bold hover:border-brand hover:text-brand transition-colors disabled:opacity-50",children:r},c))}),e.jsxs("div",{className:"p-3 pt-0 flex gap-2 items-end",children:[e.jsx("textarea",{value:o,onChange:r=>p(r.target.value),onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),j())},placeholder:"Type your question...",className:"flex-1 bg-bg border border-border rounded-xl p-3 text-sm focus:border-brand outline-none resize-none h-[50px] leading-normal scrollbar-hide",disabled:t}),a?e.jsxs("button",{onClick:k,disabled:t,className:"h-[50px] px-4 bg-card border border-border rounded-xl text-xs font-bold hover:bg-brand hover:text-white hover:border-brand transition-all flex flex-col items-center justify-center gap-1 min-w-[60px]",title:"Save to Note",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),e.jsx("span",{children:"Save"})]}):e.jsx("button",{onClick:j,disabled:!o.trim()||t,className:"h-[50px] w-[50px] bg-brand text-white rounded-xl flex items-center justify-center hover:opacity-90 disabled:opacity-50 transition-all shadow-lg shadow-brand/20",children:t?e.jsx("div",{className:"w-4 h-4 border-2 border-white/50 border-t-white rounded-full animate-spin"}):e.jsx("svg",{className:"w-5 h-5 ml-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),e.jsxs("div",{className:"px-4 pb-2 flex justify-between items-center text-[10px] opacity-40 font-mono",children:[e.jsx("span",{children:i.provider==="gemini"?"Google Gemini":i.provider==="groq"?"Groq Llama":"AI Provider"}),e.jsx("span",{children:h.id})]})]})]})};export{G as AIStudyModal};
